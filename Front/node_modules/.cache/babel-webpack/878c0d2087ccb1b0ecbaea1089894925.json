{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/user/OneDrive/\\u05DE\\u05E1\\u05DE\\u05DB\\u05D9\\u05DD/fullstack/ANGULAR/SECONDRESTORE/Front/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport store from 'src/app/redux/store';\nimport { environment } from 'src/environments/environment';\nimport ItemModel from 'src/app/models/item.model';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"src/app/services/item.service\";\nimport * as i3 from \"src/app/services/notify.service\";\nimport * as i4 from \"src/app/services/order.service\";\nimport * as i5 from \"src/app/services/carts.service\";\nimport * as i6 from \"@angular/common\";\nimport * as i7 from \"../total-cart/total-cart.component\";\nimport * as i8 from \"@angular/material/form-field\";\nimport * as i9 from \"@angular/material/input\";\nimport * as i10 from \"@angular/forms\";\nimport * as i11 from \"@angular/material/icon\";\nimport * as i12 from \"../item-card/item-card.component\";\nimport * as i13 from \"@angular/material/button\";\n\nfunction CartMenuComponent_div_0_mat_form_field_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"mat-form-field\");\n    i0.ɵɵelementStart(1, \"input\", 7);\n    i0.ɵɵlistener(\"ngModelChange\", function CartMenuComponent_div_0_mat_form_field_2_Template_input_ngModelChange_1_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext(2);\n      return ctx_r4.searchQuery = $event;\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(2, \"mat-placeholder\");\n    i0.ɵɵtext(3, \"Search in cart...\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"mat-icon\", 8);\n    i0.ɵɵtext(5, \"search\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngModel\", ctx_r1.searchQuery);\n  }\n}\n\nfunction CartMenuComponent_div_0_app_item_card_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"app-item-card\", 9);\n  }\n\n  if (rf & 2) {\n    const i_r6 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"item\", i_r6)(\"items\", ctx_r2.items)(\"cart\", ctx_r2.cart)(\"searchQuery\", ctx_r2.searchQuery)(\"deleteItem\", ctx_r2.deleteItem)(\"getLastCart\", ctx_r2.getLastCart)(\"user\", ctx_r2.user);\n  }\n}\n\nfunction CartMenuComponent_div_0_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵelementStart(1, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function CartMenuComponent_div_0_div_7_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return ctx_r7.order();\n    });\n    i0.ɵɵelementStart(2, \"mat-icon\");\n    i0.ɵɵtext(3, \"send\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(4, \" Submit your order \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function CartMenuComponent_div_0_div_7_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r9 = i0.ɵɵnextContext(2);\n      return ctx_r9.deleteCart(ctx_r9.cart[0].CartID);\n    });\n    i0.ɵɵelementStart(6, \"mat-icon\");\n    i0.ɵɵtext(7, \"delete_forever\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(8, \" Empty your cart \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction CartMenuComponent_div_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 1);\n    i0.ɵɵelementStart(1, \"div\", 2);\n    i0.ɵɵtemplate(2, CartMenuComponent_div_0_mat_form_field_2_Template, 6, 1, \"mat-form-field\", 3);\n    i0.ɵɵelementStart(3, \"h5\");\n    i0.ɵɵtext(4, \"My Cart\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, CartMenuComponent_div_0_app_item_card_5_Template, 1, 7, \"app-item-card\", 4);\n    i0.ɵɵelement(6, \"app-total-cart\", 5);\n    i0.ɵɵtemplate(7, CartMenuComponent_div_0_div_7_Template, 9, 0, \"div\", 6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.isOrder());\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.items);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"totalCart\", ctx_r0.totalCart)(\"cart\", ctx_r0.cart);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.totalCart > 0);\n  }\n}\n\nexport class CartMenuComponent {\n  constructor(myActivatedRoute, myItemService, notify, myOrdersService, myCartService, myRouter) {\n    var _this = this;\n\n    this.myActivatedRoute = myActivatedRoute;\n    this.myItemService = myItemService;\n    this.notify = notify;\n    this.myOrdersService = myOrdersService;\n    this.myCartService = myCartService;\n    this.myRouter = myRouter;\n    this.totalCart = 0;\n    this.imageUrl = environment.productImagesUrl;\n    this.searchQuery = ''; // for observable\n\n    this.subscription = this.myItemService.getCartObservable().subscribe( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (addedItem) {\n        if (addedItem) {\n          console.log(addedItem); // UPDATE\n\n          const itemToPush = new ItemModel();\n          itemToPush.ProductName = addedItem.name; // needs that because of num/string problems\n\n          itemToPush.ItemID = addedItem.item.ItemID;\n          itemToPush.Quantity = addedItem.item.Quantity;\n          itemToPush.TotalPrice = addedItem.item.TotalPrice;\n          itemToPush.imageName = addedItem.item.ProductID + \".jpg\";\n\n          if (_this.items) {\n            _this.items.push(itemToPush);\n          } else {\n            const itemsArray = [itemToPush];\n            _this.items = itemsArray;\n            _this.openCart = true;\n            _this.cart[0].CartID = addedItem.item.CartID;\n          }\n\n          _this.totalCart = _this.myItemService.totalCartPerUser(_this.items);\n\n          _this.myCartService.cartUpdate(false, _this.totalCart, addedItem.item.CartID);\n        } else {// clear messages when empty message received\n          // this.messages = [];\n        }\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }\n\n  ngOnInit() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      _this2.unsubscribeMe = store.subscribe(() => {\n        _this2.user = store.getState().authState.user;\n      }); // shai says this way the loggin in user will be shown automatically\n\n      if (JSON.parse(localStorage.getItem('user'))) {\n        _this2.user = store.getState().authState.user;\n      } // GETS LAST ORDER\n\n\n      try {\n        _this2.orders = yield _this2.myOrdersService.getLastOrderByUser(_this2.user.uuid);\n      } catch (err) {\n        _this2.notify.error(err);\n      } // GETS LAST CART (OPEN OR CLOSED)\n\n\n      try {\n        _this2.cart = yield _this2.myCartService.getLastCartByUser(_this2.user.uuid);\n      } catch (err) {\n        _this2.notify.error(err);\n      } // CHECKS IF THE LAST CART IS OPEN (no match for last order)\n\n\n      if (_this2.orders[0].CartID === _this2.cart[0].CartID) {\n        _this2.openCart = false;\n      } else {\n        _this2.openCart = true;\n      } // if there is an open cart -> get this.cart items\n\n\n      if (_this2.openCart) {\n        try {\n          _this2.items = yield _this2.myItemService.getOpenCartItems(_this2.cart[0].CartID);\n        } catch (err) {\n          if (!_this2.items) {\n            // this.items = [];\n            yield _this2.myCartService.deleteCart(_this2.cart[0].CartID);\n\n            _this2.getLastCart();\n          }\n\n          ; // if teh cart is empty ot items (aftr removal of an item ) -> delete the cart as well\n        }\n      }\n\n      _this2.totalCart = _this2.myItemService.totalCartPerUser(_this2.items);\n    })();\n  }\n\n  ngOnDestroy() {\n    this.unsubscribeMe();\n  }\n\n  getLastCart() {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        _this3.cart = yield _this3.myCartService.getLastCartByUser(_this3.user.uuid);\n      } catch (err) {\n        _this3.notify.error(err);\n      }\n    })();\n  }\n\n  deleteItem(id) {\n    var _this4 = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        const answer = confirm(\"Are you sure you want to remove this item?\");\n        if (!answer) return;\n        yield _this4.myItemService.deleteItem(id); // to delete it from screen in real time\n\n        const index = _this4.items.findIndex(p => p.ItemID === id);\n\n        _this4.items.splice(index, 1);\n\n        _this4.notify.success(\"Item has been removed from cart.\");\n\n        _this4.totalCart = _this4.myItemService.totalCartPerUser(_this4.items);\n\n        _this4.myCartService.cartUpdate(false, _this4.totalCart, _this4.cart[0].CartID); // mainly used for sending totalCart\n        // then it send an automatic request to get GET all cart items, and then if it's empty already it's deleted...\n\n      } catch (err) {\n        // if (!this.cartItems) { await this.myCartService.deleteCart(this.cart[0].CartID)};\n        _this4.notify.error(err);\n      }\n\n      _this4.totalCart = _this4.myItemService.totalCartPerUser(_this4.items);\n      console.log(\"total cart: \" + _this4.totalCart); // מה קורה אם מחקתי את הפריט האחרון? צריך למחוק את העגלה?\n\n      if (_this4.items.length === 0) {\n        _this4.totalCart = 0; // already above\n\n        yield _this4.myCartService.deleteCart(_this4.cart[0].CartID);\n\n        _this4.myCartService.cartUpdate(true, 0, -1); // notifies produst card that cart is closed\n        // cartId = -1 --> because it's not used when cartClosed is true\n        // this.openCart = false;\n        // this.items = undefined;\n\n\n        _this4.getLastCart();\n      }\n\n      ; // if (this.cartItems.length === 0) {this.deleteCart(this.cart[0].CartID)};\n    })();\n  } // THIS IS THE ACTUAL EMPTY CART ALSO DELETES CART'S ITEMS\n\n\n  deleteCart(cartId) {\n    var _this5 = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        const answer = confirm(\"Are you sure you want to empty your cart?\");\n        if (!answer) return;\n\n        _this5.emptyCart(cartId); // delete all cart's items\n\n\n        yield _this5.myCartService.deleteCart(cartId);\n        _this5.openCart = false;\n        _this5.items = undefined; // this.items = [];\n\n        _this5.notify.success(\"Cart has been emptied.\");\n\n        _this5.myCartService.cartUpdate(true, 0, -1); // notifies produst card that cart is closed\n        // cartId = -1 --> because it's not used when cartClosed is true\n\n\n        _this5.getLastCart(); // this.myRouter.navigateByUrl(\"/products\");\n\n      } catch (err) {\n        _this5.notify.error(err);\n      }\n    })();\n  } // deletes all the items of a (deleted) cart from db\n\n\n  emptyCart(cartId) {\n    var _this6 = this;\n\n    return _asyncToGenerator(function* () {\n      try {\n        yield _this6.myItemService.deleteAllItemsOfCart(cartId);\n\n        _this6.notify.success(\"emptied all items.\"); // this.items = undefined; // i yhik i don't need it\n\n\n        _this6.myCartService.cartUpdate(true, 0, -1); // notifies produst card that cart is closed\n        // cartId = -1 --> because it's not used when cartClosed is true\n\n      } catch (err) {\n        _this6.notify.error(err);\n      }\n    })();\n  }\n\n  order() {\n    this.myRouter.navigateByUrl(\"/order\");\n  }\n\n  isNotHome() {\n    const h = this.myRouter.url.includes(\"/home\");\n    return !h;\n  }\n\n  isOrder() {\n    const o = this.myRouter.url.includes(\"/order\");\n    return o;\n  }\n\n}\n\nCartMenuComponent.ɵfac = function CartMenuComponent_Factory(t) {\n  return new (t || CartMenuComponent)(i0.ɵɵdirectiveInject(i1.ActivatedRoute), i0.ɵɵdirectiveInject(i2.ItemService), i0.ɵɵdirectiveInject(i3.NotifyService), i0.ɵɵdirectiveInject(i4.OrderService), i0.ɵɵdirectiveInject(i5.CartsService), i0.ɵɵdirectiveInject(i1.Router));\n};\n\nCartMenuComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: CartMenuComponent,\n  selectors: [[\"app-cart-menu\"]],\n  decls: 1,\n  vars: 1,\n  consts: [[\"class\", \"main\", 4, \"ngIf\"], [1, \"main\"], [\"id\", \"start\"], [4, \"ngIf\"], [3, \"item\", \"items\", \"cart\", \"searchQuery\", \"deleteItem\", \"getLastCart\", \"user\", 4, \"ngFor\", \"ngForOf\"], [3, \"totalCart\", \"cart\"], [\"class\", \"buttons\", 4, \"ngIf\"], [\"matInput\", \"\", \"type\", \"text\", 3, \"ngModel\", \"ngModelChange\"], [\"matSuffix\", \"\", 2, \"font-size\", \"1.2em\"], [3, \"item\", \"items\", \"cart\", \"searchQuery\", \"deleteItem\", \"getLastCart\", \"user\"], [1, \"buttons\"], [\"mat-stroked-button\", \"\", 3, \"click\"]],\n  template: function CartMenuComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, CartMenuComponent_div_0_Template, 8, 5, \"div\", 0);\n    }\n\n    if (rf & 2) {\n      i0.ɵɵproperty(\"ngIf\", ctx.user && ctx.isNotHome());\n    }\n  },\n  directives: [i6.NgIf, i6.NgForOf, i7.TotalCartComponent, i8.MatFormField, i9.MatInput, i10.DefaultValueAccessor, i10.NgControlStatus, i10.NgModel, i8.MatPlaceholder, i11.MatIcon, i8.MatSuffix, i12.ItemCardComponent, i13.MatButton],\n  styles: [\"img[_ngcontent-%COMP%] {\\r\\n    width: 30px;\\r\\n    height: 30px;\\r\\n    margin: 5px;\\r\\n    border-radius: 10px;\\r\\n    border: 1px solid black;\\r\\n    vertical-align: middle;\\r\\n    margin-left: auto;\\r\\n}\\r\\n\\r\\n.main[_ngcontent-%COMP%] {\\r\\n    width: 100%;\\r\\n    height: 100%;\\r\\n    overflow: visible;\\r\\n}\\r\\n\\r\\n.buttons[_ngcontent-%COMP%] {\\r\\n    display: inline-block;\\r\\n    position: relative;\\r\\n    margin-top: 50px;\\r\\n}\\r\\n\\r\\napp-total-cart[_ngcontent-%COMP%] {\\r\\n    margin: 10px;\\r\\n}\\r\\n\\r\\ndiv[_ngcontent-%COMP%] {\\r\\n    float:left; \\r\\n    clear: left;\\r\\n    align-items: center;\\r\\n    padding-right: 0;\\r\\n    text-align: left;\\r\\n}\\r\\n\\r\\nh5[_ngcontent-%COMP%] {\\r\\n    width: 400px;\\r\\n    text-align: center;\\r\\n}\\r\\n\\r\\n#start[_ngcontent-%COMP%] {\\r\\n    position: fixed;\\r\\n    height: 800px;\\r\\n    left: 20px;\\r\\n    top: 200px;\\r\\n    text-align:center;\\r\\n    display: flex;\\r\\n  flex-direction: column;\\r\\n  align-items: flex-start;\\r\\n\\r\\n}\\r\\n\\r\\n#kupa[_ngcontent-%COMP%] {\\r\\n    width: 85%;\\r\\n    height:547px;\\r\\n}\\r\\n\\r\\nbutton[_ngcontent-%COMP%] {\\r\\n    width: 50%;\\r\\n    margin-bottom: 20px;\\r\\n}\\r\\n\\r\\nmat-form-field[_ngcontent-%COMP%] {\\r\\n    position: fixed;\\r\\n    left: 10px;\\r\\n    top: 120px;\\r\\n}\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhcnQtbWVudS5jb21wb25lbnQuY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0lBQ0ksV0FBVztJQUNYLFlBQVk7SUFDWixXQUFXO0lBQ1gsbUJBQW1CO0lBQ25CLHVCQUF1QjtJQUN2QixzQkFBc0I7SUFDdEIsaUJBQWlCO0FBQ3JCOztBQUVBO0lBQ0ksV0FBVztJQUNYLFlBQVk7SUFDWixpQkFBaUI7QUFDckI7O0FBRUE7SUFDSSxxQkFBcUI7SUFDckIsa0JBQWtCO0lBQ2xCLGdCQUFnQjtBQUNwQjs7QUFFQTtJQUNJLFlBQVk7QUFDaEI7O0FBRUE7SUFDSSxVQUFVO0lBQ1YsV0FBVztJQUNYLG1CQUFtQjtJQUNuQixnQkFBZ0I7SUFDaEIsZ0JBQWdCO0FBQ3BCOztBQUVBO0lBQ0ksWUFBWTtJQUNaLGtCQUFrQjtBQUN0Qjs7QUFFQTtJQUNJLGVBQWU7SUFDZixhQUFhO0lBQ2IsVUFBVTtJQUNWLFVBQVU7SUFDVixpQkFBaUI7SUFDakIsYUFBYTtFQUNmLHNCQUFzQjtFQUN0Qix1QkFBdUI7O0FBRXpCOztBQUVBO0lBQ0ksVUFBVTtJQUNWLFlBQVk7QUFDaEI7O0FBRUE7SUFDSSxVQUFVO0lBQ1YsbUJBQW1CO0FBQ3ZCOztBQUVBO0lBQ0ksZUFBZTtJQUNmLFVBQVU7SUFDVixVQUFVO0FBQ2QiLCJmaWxlIjoiY2FydC1tZW51LmNvbXBvbmVudC5jc3MiLCJzb3VyY2VzQ29udGVudCI6WyJpbWcge1xyXG4gICAgd2lkdGg6IDMwcHg7XHJcbiAgICBoZWlnaHQ6IDMwcHg7XHJcbiAgICBtYXJnaW46IDVweDtcclxuICAgIGJvcmRlci1yYWRpdXM6IDEwcHg7XHJcbiAgICBib3JkZXI6IDFweCBzb2xpZCBibGFjaztcclxuICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XHJcbiAgICBtYXJnaW4tbGVmdDogYXV0bztcclxufVxyXG5cclxuLm1haW4ge1xyXG4gICAgd2lkdGg6IDEwMCU7XHJcbiAgICBoZWlnaHQ6IDEwMCU7XHJcbiAgICBvdmVyZmxvdzogdmlzaWJsZTtcclxufVxyXG5cclxuLmJ1dHRvbnMge1xyXG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xyXG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xyXG4gICAgbWFyZ2luLXRvcDogNTBweDtcclxufVxyXG5cclxuYXBwLXRvdGFsLWNhcnQge1xyXG4gICAgbWFyZ2luOiAxMHB4O1xyXG59XHJcblxyXG5kaXYge1xyXG4gICAgZmxvYXQ6bGVmdDsgXHJcbiAgICBjbGVhcjogbGVmdDtcclxuICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7XHJcbiAgICBwYWRkaW5nLXJpZ2h0OiAwO1xyXG4gICAgdGV4dC1hbGlnbjogbGVmdDtcclxufVxyXG5cclxuaDUge1xyXG4gICAgd2lkdGg6IDQwMHB4O1xyXG4gICAgdGV4dC1hbGlnbjogY2VudGVyO1xyXG59XHJcblxyXG4jc3RhcnQge1xyXG4gICAgcG9zaXRpb246IGZpeGVkO1xyXG4gICAgaGVpZ2h0OiA4MDBweDtcclxuICAgIGxlZnQ6IDIwcHg7XHJcbiAgICB0b3A6IDIwMHB4O1xyXG4gICAgdGV4dC1hbGlnbjpjZW50ZXI7XHJcbiAgICBkaXNwbGF5OiBmbGV4O1xyXG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XHJcbiAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XHJcblxyXG59XHJcblxyXG4ja3VwYSB7XHJcbiAgICB3aWR0aDogODUlO1xyXG4gICAgaGVpZ2h0OjU0N3B4O1xyXG59XHJcblxyXG5idXR0b24ge1xyXG4gICAgd2lkdGg6IDUwJTtcclxuICAgIG1hcmdpbi1ib3R0b206IDIwcHg7XHJcbn1cclxuXHJcbm1hdC1mb3JtLWZpZWxkIHtcclxuICAgIHBvc2l0aW9uOiBmaXhlZDtcclxuICAgIGxlZnQ6IDEwcHg7XHJcbiAgICB0b3A6IDEyMHB4O1xyXG59Il19 */\"]\n});","map":{"version":3,"sources":["C:\\Users\\user\\OneDrive\\מסמכים\\fullstack\\ANGULAR\\SECONDRESTORE\\Front\\src\\app\\components\\cart-area\\cart-menu\\cart-menu.component.ts","C:\\Users\\user\\OneDrive\\מסמכים\\fullstack\\ANGULAR\\SECONDRESTORE\\Front\\src\\app\\components\\cart-area\\cart-menu\\cart-menu.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { Unsubscribe } from 'redux';\nimport { Subscription } from 'rxjs';\nimport CartModel from 'src/app/models/cart.model';\nimport OrderModel from 'src/app/models/order.model';\nimport UserModel from 'src/app/models/user.model';\nimport store from 'src/app/redux/store';\nimport { CartsService } from 'src/app/services/carts.service';\nimport { NotifyService } from 'src/app/services/notify.service';\nimport { OrderService } from 'src/app/services/order.service';\nimport { environment } from 'src/environments/environment';\nimport { ItemService } from 'src/app/services/item.service';\nimport ItemModel from 'src/app/models/item.model';\n\n@Component({\n  selector: 'app-cart-menu',\n  templateUrl: './cart-menu.component.html',\n  styleUrls: ['./cart-menu.component.css']\n})\n\n  export class CartMenuComponent implements OnInit, OnDestroy {\n\n  public user: UserModel;\n  private unsubscribeMe: Unsubscribe;\n  public items: ItemModel[];\n  public cart: CartModel[];\n  public totalCart: number = 0;\n  public orders: OrderModel[];\n  public openCart: boolean;\n  public imageUrl = environment.productImagesUrl;\n\n  // for observable\n  private subscription: Subscription;\n\n  searchQuery: string = '';\n\n    constructor( private myActivatedRoute: ActivatedRoute, \n                  private myItemService: ItemService, \n                  private notify: NotifyService, \n                  private myOrdersService: OrderService,\n                  private myCartService: CartsService,\n                  private myRouter: Router,\n                  ) {  \n\n                    // for observable\n                    this.subscription = this.myItemService.getCartObservable().subscribe(async addedItem => {\n                      if (addedItem) {\n                          console.log(addedItem);\n                          // UPDATE\n                          const itemToPush = new ItemModel();\n                          itemToPush.ProductName = addedItem.name;\n                          // needs that because of num/string problems\n                          itemToPush.ItemID = addedItem.item.ItemID;\n                          itemToPush.Quantity = addedItem.item.Quantity;\n                          itemToPush.TotalPrice = addedItem.item.TotalPrice;\n                          itemToPush.imageName = addedItem.item.ProductID + \".jpg\"\n                          if (this.items) {\n                            this.items.push(itemToPush);\n                          } else {\n                            const itemsArray = [itemToPush];\n                            this.items = itemsArray;\n                            this.openCart = true; \n                            this.cart[0].CartID = addedItem.item.CartID;   \n                          }\n                          this.totalCart = this.myItemService.totalCartPerUser(this.items);\n                          this.myCartService.cartUpdate(false, this.totalCart, addedItem.item.CartID);\n                      } else {\n                          // clear messages when empty message received\n                          // this.messages = [];\n                      }\n                  });\n\n                    }\n\n async ngOnInit() {\n      this.unsubscribeMe = store.subscribe(() => {\n          this.user = store.getState().authState.user;\n      });\n\n      // shai says this way the loggin in user will be shown automatically\n      if (JSON.parse(localStorage.getItem('user'))) {\n          this.user = store.getState().authState.user;\n      }\n    \n       // GETS LAST ORDER\n      try {\n        this.orders = await this.myOrdersService.getLastOrderByUser(this.user.uuid);        \n      }\n      catch (err) {\n          this.notify.error(err);\n      }\n\n      // GETS LAST CART (OPEN OR CLOSED)\n      try {\n        this.cart = await this.myCartService.getLastCartByUser(this.user.uuid);   \n      } catch (err) {\n          this.notify.error(err);\n      }\n\n      // CHECKS IF THE LAST CART IS OPEN (no match for last order)\n      if (this.orders[0].CartID === this.cart[0].CartID) {this.openCart = false} else {this.openCart = true}\n\n      // if there is an open cart -> get this.cart items\n      if (this.openCart) {\n        try {\n          this.items = await this.myItemService.getOpenCartItems(this.cart[0].CartID);      \n        } catch (err) {\n          if (!this.items) { \n            // this.items = [];\n            await this.myCartService.deleteCart(this.cart[0].CartID);\n            this.getLastCart();\n          };  // if teh cart is empty ot items (aftr removal of an item ) -> delete the cart as well\n        }\n      }\n\n      this.totalCart = this.myItemService.totalCartPerUser(this.items);\n\n  }\n\n  ngOnDestroy(): void {\n      this.unsubscribeMe();\n  }\n\n  public async getLastCart() {\n    try {\n      this.cart = await this.myCartService.getLastCartByUser(this.user.uuid);   \n    } catch (err) {\n        this.notify.error(err);\n    }\n  }\n\n  public async deleteItem(id: number) {\n    try {\n        const answer = confirm(\"Are you sure you want to remove this item?\");\n        if (!answer) return;\n        await this.myItemService.deleteItem(id);\n\n        // to delete it from screen in real time\n        const index = this.items.findIndex(p => p.ItemID === id);\n          this.items.splice(index, 1);\n        this.notify.success(\"Item has been removed from cart.\");\n        this.totalCart = this.myItemService.totalCartPerUser(this.items);\n        this.myCartService.cartUpdate(false, this.totalCart, this.cart[0].CartID); // mainly used for sending totalCart\n\n        // then it send an automatic request to get GET all cart items, and then if it's empty already it's deleted...\n    }\n    catch (err) {\n      // if (!this.cartItems) { await this.myCartService.deleteCart(this.cart[0].CartID)};\n        this.notify.error(err);\n    }\n    this.totalCart = this.myItemService.totalCartPerUser(this.items);\n    console.log(\"total cart: \" + this.totalCart);\n    // מה קורה אם מחקתי את הפריט האחרון? צריך למחוק את העגלה?\n    if (this.items.length === 0) { \n      this.totalCart = 0; // already above\n      await this.myCartService.deleteCart(this.cart[0].CartID);\n      this.myCartService.cartUpdate(true, 0, -1); // notifies produst card that cart is closed\n          // cartId = -1 --> because it's not used when cartClosed is true\n      // this.openCart = false;\n      // this.items = undefined;\n      this.getLastCart();\n    };\n    // if (this.cartItems.length === 0) {this.deleteCart(this.cart[0].CartID)};\n  }\n\n  // THIS IS THE ACTUAL EMPTY CART ALSO DELETES CART'S ITEMS\n  public async deleteCart(cartId: number) {\n    try {\n      const answer = confirm(\"Are you sure you want to empty your cart?\");\n      if (!answer) return;\n      this.emptyCart(cartId);  // delete all cart's items\n      await this.myCartService.deleteCart(cartId);\n      this.openCart = false;\n      this.items = undefined;\n      // this.items = [];\n      this.notify.success(\"Cart has been emptied.\");\n      this.myCartService.cartUpdate(true, 0, -1); // notifies produst card that cart is closed\n          // cartId = -1 --> because it's not used when cartClosed is true\n\n      this.getLastCart();\n      // this.myRouter.navigateByUrl(\"/products\");\n    }\n    catch (err) {\n      this.notify.error(err);\n    }\n  }\n\n  // deletes all the items of a (deleted) cart from db\n  async emptyCart(cartId: number) {\n    try {\n      await this.myItemService.deleteAllItemsOfCart(cartId);\n      this.notify.success(\"emptied all items.\");\n      // this.items = undefined; // i yhik i don't need it\n      this.myCartService.cartUpdate(true, 0, -1); // notifies produst card that cart is closed\n          // cartId = -1 --> because it's not used when cartClosed is true\n\n    }\n    catch (err) {\n      this.notify.error(err);\n    }\n  }\n\n  order() {\n    this.myRouter.navigateByUrl(\"/order\");\n  }\n\n  public isNotHome() {\n    const h = this.myRouter.url.includes(\"/home\");\n    return !h\n  }\n\n\n  public isOrder() {\n    const o = this.myRouter.url.includes(\"/order\");\n  return o\n  }\n\n  // public itemsExist() {\n    // if (this.items.length>0) {\n      // return true \n    // } else {\n      // return false\n    // }\n  // }\n\n}\n\n\n\n// import { Component, OnDestroy, OnInit } from '@angular/core';\n// import { ActivatedRoute, Router } from '@angular/router';\n// import { Unsubscribe } from 'redux';\n// import { Subscription } from 'rxjs';\n// import CartModel from 'src/app/models/cart.model';\n// import OrderModel from 'src/app/models/order.model';\n// import UserModel from 'src/app/models/user.model';\n// import store from 'src/app/redux/store';\n// import { CartsService } from 'src/app/services/carts.service';\n// import { NotifyService } from 'src/app/services/notify.service';\n// import { OrderService } from 'src/app/services/order.service';\n// import { environment } from 'src/environments/environment';\n// import { ItemService } from 'src/app/services/item.service';\n// import ItemModel from 'src/app/models/item.model';\n\n// @Component({\n//   selector: 'app-cart-menu',\n//   templateUrl: './cart-menu.component.html',\n//   styleUrls: ['./cart-menu.component.css']\n// })\n\n//   export class CartMenuComponent implements OnInit, OnDestroy {\n\n//   public user: UserModel;\n//   private unsubscribeMe: Unsubscribe;\n//   public items: ItemModel[];\n//   public cart: CartModel[];\n//   public totalCart: number = 0;\n//   public orders: OrderModel[];\n//   public openCart: boolean;\n//   public imageUrl = environment.productImagesUrl;\n\n//   // for observable\n//   private subscription: Subscription;\n\n//   searchQuery: string = '';\n\n//     constructor( private myActivatedRoute: ActivatedRoute, \n//                   private myItemService: ItemService, \n//                   private notify: NotifyService, \n//                   private myOrdersService: OrderService,\n//                   private myCartService: CartsService,\n//                   private myRouter: Router,\n//                   ) {  \n\n//                     // for observable\n//                     this.subscription = this.myItemService.getCartObservable().subscribe(async addedItem => {\n//                       if (addedItem) {\n//                           console.log(addedItem);\n//                           // UPDATE\n//                           const itemToPush = new ItemModel();\n//                           itemToPush.ProductName = addedItem.name;\n//                           // needs that because of num/string problems\n//                           itemToPush.ItemID = addedItem.item.ItemID;\n//                           itemToPush.Quantity = addedItem.item.Quantity;\n//                           itemToPush.TotalPrice = addedItem.item.TotalPrice;\n//                           itemToPush.imageName = addedItem.item.ProductID + \".jpg\"\n//                           if (this.items) {\n//                             this.items.push(itemToPush);\n//                           } else {\n//                             const itemsArray = [itemToPush];\n//                             this.items = itemsArray;\n//                             this.openCart = true; \n//                             this.cart[0].CartID = addedItem.item.CartID;   \n//                           }\n//                           this.totalCart = this.myItemService.totalCartPerUser(this.items);\n//                           this.myCartService.cartUpdate(false, this.totalCart, addedItem.item.CartID);\n//                       } else {\n//                           // clear messages when empty message received\n//                           // this.messages = [];\n//                       }\n//                   });\n\n//                     }\n\n//  async ngOnInit() {\n//       this.unsubscribeMe = store.subscribe(() => {\n//           this.user = store.getState().authState.user;\n//       });\n\n//       // shai says this way the loggin in user will be shown automatically\n//       if (JSON.parse(localStorage.getItem('user'))) {\n//           this.user = store.getState().authState.user;\n//       }\n    \n//        // GETS LAST ORDER\n//       try {\n//         this.orders = await this.myOrdersService.getLastOrderByUser(this.user.uuid);        \n//       }\n//       catch (err) {\n//           this.notify.error(err);\n//       }\n\n//       // GETS LAST CART (OPEN OR CLOSED)\n//       try {\n//         this.cart = await this.myCartService.getLastCartByUser(this.user.uuid);   \n//       } catch (err) {\n//           this.notify.error(err);\n//       }\n\n//       // CHECKS IF THE LAST CART IS OPEN (no match for last order)\n//       if (this.orders[0].CartID === this.cart[0].CartID) {this.openCart = false} else {this.openCart = true}\n\n//       // if there is an open cart -> get this.cart items\n//       if (this.openCart) {\n//         try {\n//           this.items = await this.myItemService.getOpenCartItems(this.cart[0].CartID);      \n//         } catch (err) {\n//           if (!this.items) { \n//             await this.myCartService.deleteCart(this.cart[0].CartID);\n//             this.getLastCart();\n//           };  // if teh cart is empty ot items (aftr removal of an item ) -> delete the cart as well\n//         }\n//       }\n\n//       this.totalCart = this.myItemService.totalCartPerUser(this.items);\n\n//   }\n\n//   ngOnDestroy(): void {\n//       this.unsubscribeMe();\n//   }\n\n//   public async getLastCart() {\n//     try {\n//       this.cart = await this.myCartService.getLastCartByUser(this.user.uuid);   \n//     } catch (err) {\n//         this.notify.error(err);\n//     }\n//   }\n\n//   public async deleteItem(id: number) {\n//     try {\n//         const answer = confirm(\"Are you sure you want to remove this item?\");\n//         if (!answer) return;\n//         await this.myItemService.deleteItem(id);\n\n//         // to delete it from screen in real time\n//         const index = this.items.findIndex(p => p.ItemID === id);\n//           this.items.splice(index, 1);\n//         this.notify.success(\"Item has been removed from cart.\");\n//         this.totalCart = this.myItemService.totalCartPerUser(this.items);\n//         this.myCartService.cartUpdate(false, this.totalCart, this.cart[0].CartID); // mainly used for sending totalCart\n\n//         // then it send an automatic request to get GET all cart items, and then if it's empty already it's deleted...\n//     }\n//     catch (err) {\n//       // if (!this.cartItems) { await this.myCartService.deleteCart(this.cart[0].CartID)};\n//         this.notify.error(err);\n//     }\n//     this.totalCart = this.myItemService.totalCartPerUser(this.items);\n//     console.log(\"total cart: \" + this.totalCart);\n//     // מה קורה אם מחקתי את הפריט האחרון? צריך למחוק את העגלה?\n//     if (this.items.length === 0) { \n//       this.totalCart = 0; // already above\n//       await this.myCartService.deleteCart(this.cart[0].CartID);\n//       this.myCartService.cartUpdate(true, 0, -1); // notifies produst card that cart is closed\n//           // cartId = -1 --> because it's not used when cartClosed is true\n\n//       this.getLastCart();\n//     };\n//     // if (this.cartItems.length === 0) {this.deleteCart(this.cart[0].CartID)};\n//   }\n\n//   // THIS IS THE ACTUAL EMPTY CART ALSO DELETES CART'S ITEMS\n//   public async deleteCart(cartId: number) {\n//     try {\n//       const answer = confirm(\"Are you sure you want to empty your cart?\");\n//       if (!answer) return;\n//       this.emptyCart(cartId);  // delete all cart's items\n//       await this.myCartService.deleteCart(cartId);\n//       this.openCart = false;\n//       this.items = undefined;\n//       this.notify.success(\"Cart has been emptied.\");\n//       this.myCartService.cartUpdate(true, 0, -1); // notifies produst card that cart is closed\n//           // cartId = -1 --> because it's not used when cartClosed is true\n\n//       this.getLastCart();\n//       // this.myRouter.navigateByUrl(\"/products\");\n//     }\n//     catch (err) {\n//       this.notify.error(err);\n//     }\n//   }\n\n//   // deletes all the items of a (deleted) cart\n//   async emptyCart(cartId: number) {\n//     try {\n//       await this.myItemService.deleteAllItemsOfCart(cartId);\n//       // this.items = undefined; // i yhik i don't need it\n//       this.myCartService.cartUpdate(true, 0, -1); // notifies produst card that cart is closed\n//           // cartId = -1 --> because it's not used when cartClosed is true\n\n//     }\n//     catch (err) {\n//       this.notify.error(err);\n//     }\n//   }\n\n//   order() {\n//     this.myRouter.navigateByUrl(\"/order\");\n//   }\n\n//   public isNotHome() {\n//     const h = this.myRouter.url.includes(\"/home\");\n//     return !h\n//   }\n\n\n//   public isOrder() {\n//     const o = this.myRouter.url.includes(\"/order\");\n//   return o\n//   }\n\n// }\n","<!-- <div class=\"main\" *ngIf=\"(user && isNotHome())\">\n    <div id=\"start\">\n        <mat-form-field *ngIf=\"isOrder()\">\n            <input matInput type=\"text\" [(ngModel)]=\"searchQuery\"/>\n            <mat-placeholder>Search in cart...</mat-placeholder>\n            <mat-icon matSuffix style=\"font-size: 1.2em\">search</mat-icon>\n        </mat-form-field>    \n        <h5>My Cart</h5>\n        <app-item-card *ngFor=\"let i of items\" [item]=\"i\" [items]=\"items\" \n        [cart]=\"cart\" [searchQuery]=\"searchQuery\" [deleteItem]=\"deleteItem\" \n        [getLastCart]=\"getLastCart\" [user]=\"user\"></app-item-card>\n\n        <app-total-cart *ngIf=\"totalCart>0\" [totalCart]=\"totalCart\"></app-total-cart>\n\n        <div class=\"buttons\" *ngIf=\"items\">\n            <button mat-stroked-button (click)=\"order()\">\n                <mat-icon>send</mat-icon>\n                Submit your order\n            </button>\n            <button mat-stroked-button (click)=\"deleteCart(cart[0].CartID)\">\n                <mat-icon>delete_forever</mat-icon>\n                Empty your cart\n            </button>\n        </div>\n    </div>    \n</div>\n -->\n\n <div class=\"main\" *ngIf=\"(user && isNotHome())\">\n    <div id=\"start\">\n        <mat-form-field *ngIf=\"isOrder()\">\n            <input matInput type=\"text\" [(ngModel)]=\"searchQuery\"/>\n            <mat-placeholder>Search in cart...</mat-placeholder>\n            <mat-icon matSuffix style=\"font-size: 1.2em\">search</mat-icon>\n        </mat-form-field>    \n        <h5>My Cart</h5>\n        <app-item-card *ngFor=\"let i of items\" [item]=\"i\" [items]=\"items\" \n        [cart]=\"cart\" [searchQuery]=\"searchQuery\" [deleteItem]=\"deleteItem\" \n        [getLastCart]=\"getLastCart\" [user]=\"user\"></app-item-card>\n\n\n\n\n        <app-total-cart [totalCart]=\"totalCart\" [cart]=\"cart\"></app-total-cart>\n        \n        <div class=\"buttons\" *ngIf=\"totalCart>0\">\n            <button mat-stroked-button (click)=\"order()\">\n                <mat-icon>send</mat-icon>\n                Submit your order\n            </button>\n            <button mat-stroked-button (click)=\"deleteCart(cart[0].CartID)\">\n                <mat-icon>delete_forever</mat-icon>\n                Empty your cart\n            </button>\n        </div>\n    </div>    \n</div>\n\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}