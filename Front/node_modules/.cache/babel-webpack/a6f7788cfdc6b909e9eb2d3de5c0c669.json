{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/user/OneDrive/\\u05DE\\u05E1\\u05DE\\u05DB\\u05D9\\u05DD/fullstack/ANGULAR/SECONDRESTORE/Front/node_modules/@angular-devkit/build-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport store from 'src/app/redux/store';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/item.service\";\nimport * as i2 from \"src/app/services/carts.service\";\nimport * as i3 from \"src/app/services/order.service\";\nimport * as i4 from \"src/app/services/notify.service\";\nimport * as i5 from \"@angular/router\";\nimport * as i6 from \"../../products-area/available-products/available-products.component\";\nimport * as i7 from \"../../order-area/orders-submitted/orders-submitted.component\";\nimport * as i8 from \"../../cart-area/cart-right/cart-right.component\";\nexport class RightComponent {\n  constructor(myItemService, myCartService, myOrdersService, notify, router) {\n    this.myItemService = myItemService;\n    this.myCartService = myCartService;\n    this.myOrdersService = myOrdersService;\n    this.notify = notify;\n    this.router = router;\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      _this.unsubscribeMe = store.subscribe(() => {\n        var _a;\n\n        _this.isAdmin = (_a = store.getState().authState.user) === null || _a === void 0 ? void 0 : _a.isAdmin;\n      });\n      _this.unsubscribeMe = store.subscribe(() => {\n        _this.user = store.getState().authState.user;\n      }); // shai says this way the loggin in user will be shown automatically\n\n      if (JSON.parse(localStorage.getItem('user'))) {\n        _this.user = store.getState().authState.user;\n      }\n\n      const uuid = _this.user.uuid;\n      console.log(\"uuid: \" + uuid); // GETS LAST ORDER\n\n      try {\n        _this.orders = yield _this.myOrdersService.getLastOrderByUser(uuid);\n      } catch (err) {\n        _this.notify.error(err);\n      } // GETS LAST CART (OPEN OR CLOSED)\n\n\n      try {\n        _this.cart = yield _this.myCartService.getLastCartByUser(uuid); // console.log(\"last cart ID\");\n        // console.log(this.cart) \n      } catch (err) {\n        _this.notify.error(err);\n      } // CHECKS IF THE LAST CART IS OPEN (no match for last order)\n\n\n      if (_this.orders[0].CartID === _this.cart[0].CartID) {\n        _this.openCart = false;\n      } else {\n        _this.openCart = true;\n      } // if there is an open cart -> get this.cart items\n\n\n      if (_this.openCart) {\n        try {\n          _this.items = yield _this.myItemService.getOpenCartItems(_this.cart[0].CartID);\n        } catch (err) {\n          _this.notify.error(err);\n        }\n      } // Total price for cart\n\n\n      if (_this.items) {\n        _this.totalCart = _this.myItemService.totalCartPerUser(_this.items);\n      }\n    })();\n  }\n\n  ngOnDestroy() {\n    this.unsubscribeMe();\n  }\n\n}\n\nRightComponent.ɵfac = function RightComponent_Factory(t) {\n  return new (t || RightComponent)(i0.ɵɵdirectiveInject(i1.ItemService), i0.ɵɵdirectiveInject(i2.CartsService), i0.ɵɵdirectiveInject(i3.OrderService), i0.ɵɵdirectiveInject(i4.NotifyService), i0.ɵɵdirectiveInject(i5.Router));\n};\n\nRightComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: RightComponent,\n  selectors: [[\"app-right\"]],\n  decls: 5,\n  vars: 6,\n  consts: [[\"src\", \"assets/images/kupa1.jpg\"], [3, \"items\", \"orders\", \"totalCart\", \"user\", \"openCart\", \"cart\"]],\n  template: function RightComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"nav\");\n      i0.ɵɵelement(1, \"img\", 0);\n      i0.ɵɵelement(2, \"app-available-products\");\n      i0.ɵɵelement(3, \"app-orders-submitted\");\n      i0.ɵɵelement(4, \"app-cart-right\", 1);\n      i0.ɵɵelementEnd();\n    }\n\n    if (rf & 2) {\n      i0.ɵɵadvance(4);\n      i0.ɵɵproperty(\"items\", ctx.items)(\"orders\", ctx.orders)(\"totalCart\", ctx.totalCart)(\"user\", ctx.user)(\"openCart\", ctx.openCart)(\"cart\", ctx.cart);\n    }\n  },\n  directives: [i6.AvailableProductsComponent, i7.OrdersSubmittedComponent, i8.CartRightComponent],\n  styles: [\"img[_ngcontent-%COMP%] {\\r\\n    display: block;\\r\\n    max-width:300px;\\r\\n    max-height:150px;\\r\\n    width: auto;\\r\\n    height: auto;\\r\\n    margin: auto;\\r\\n  }\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJpZ2h0LmNvbXBvbmVudC5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7SUFDSSxjQUFjO0lBQ2QsZUFBZTtJQUNmLGdCQUFnQjtJQUNoQixXQUFXO0lBQ1gsWUFBWTtJQUNaLFlBQVk7RUFDZCIsImZpbGUiOiJyaWdodC5jb21wb25lbnQuY3NzIiwic291cmNlc0NvbnRlbnQiOlsiaW1nIHtcclxuICAgIGRpc3BsYXk6IGJsb2NrO1xyXG4gICAgbWF4LXdpZHRoOjMwMHB4O1xyXG4gICAgbWF4LWhlaWdodDoxNTBweDtcclxuICAgIHdpZHRoOiBhdXRvO1xyXG4gICAgaGVpZ2h0OiBhdXRvO1xyXG4gICAgbWFyZ2luOiBhdXRvO1xyXG4gIH1cclxuIl19 */\"]\n});","map":{"version":3,"sources":["C:\\Users\\user\\OneDrive\\מסמכים\\fullstack\\ANGULAR\\SECONDRESTORE\\Front\\src\\app\\components\\layout-area\\right\\right.component.ts","C:\\Users\\user\\OneDrive\\מסמכים\\fullstack\\ANGULAR\\SECONDRESTORE\\Front\\src\\app\\components\\layout-area\\right\\right.component.html"],"names":[],"mappings":"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","sourcesContent":["import { Component, OnDestroy, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { Unsubscribe } from 'redux';\nimport CartModel from 'src/app/models/cart.model';\nimport OrderModel from 'src/app/models/order.model';\nimport UserModel from 'src/app/models/user.model';\nimport store from 'src/app/redux/store';\nimport { CartsService } from 'src/app/services/carts.service';\nimport { NotifyService } from 'src/app/services/notify.service';\nimport { OrderService } from 'src/app/services/order.service';\nimport { ItemService } from 'src/app/services/item.service';\nimport ItemModel from 'src/app/models/item.model';\n\n@Component({\n  selector: 'app-right',\n  templateUrl: './right.component.html',\n  styleUrls: ['./right.component.css']\n})\nexport class RightComponent implements OnInit, OnDestroy {\n  public user: UserModel;\n  public isAdmin: boolean;\n  private unsubscribeMe: Unsubscribe;\n  public items: ItemModel[];\n  public cart: CartModel[];\n  public totalCart: number;\n  public orders: OrderModel[];\n  public products: string;\n\n  public openCart: boolean;\n\n  constructor(\n    private myItemService: ItemService, \n    private myCartService: CartsService, \n    private myOrdersService: OrderService, \n    private notify: NotifyService, \n    private router: Router, \n    ) {    }\n\n\n  async ngOnInit() {\n      this.unsubscribeMe = store.subscribe(() => {\n          this.isAdmin = store.getState().authState.user?.isAdmin;\n      });\n\n      this.unsubscribeMe = store.subscribe(() => {\n          this.user = store.getState().authState.user;\n      });\n  \n      // shai says this way the loggin in user will be shown automatically\n      if (JSON.parse(localStorage.getItem('user'))) {\n          this.user = store.getState().authState.user;\n      \n      }\n\n    const uuid = this.user.uuid;\n    console.log(\"uuid: \" + uuid)\n\n    // GETS LAST ORDER\n    try {\n      this.orders = await this.myOrdersService.getLastOrderByUser(uuid);        }\n    catch (err) {\n        this.notify.error(err);\n    }\n\n    // GETS LAST CART (OPEN OR CLOSED)\n    try {\n      this.cart = await this.myCartService.getLastCartByUser(uuid);   \n      // console.log(\"last cart ID\");\n      // console.log(this.cart) \n    } catch (err) {\n        this.notify.error(err);\n    }\n\n    // CHECKS IF THE LAST CART IS OPEN (no match for last order)\n    if (this.orders[0].CartID === this.cart[0].CartID) {this.openCart = false} else {this.openCart = true}\n\n    // if there is an open cart -> get this.cart items\n    if (this.openCart) {\n      try {\n        this.items = await this.myItemService.getOpenCartItems(this.cart[0].CartID);  \n      } catch (err) {\n          this.notify.error(err);\n      }\n    }\n\n    // Total price for cart\n    if (this.items) {\n      this.totalCart = this.myItemService.totalCartPerUser(this.items);\n    }\n\n }\n  \n\n  ngOnDestroy(): void {\n      this.unsubscribeMe();\n  }\n\n \n}\n","<nav>\n    <img src=\"assets/images/kupa1.jpg\" />\n  <app-available-products></app-available-products>\n  <app-orders-submitted></app-orders-submitted>\n  <!-- <app-cart-home [carts]=\"carts\" [totalCart]=\"totalCart\" [orders]=\"orders\" [user]=\"user\"></app-cart-home> -->\n  <app-cart-right [items]=\"items\" [orders]=\"orders\" [totalCart]=\"totalCart\" [user]=\"user\" \n  [openCart]=\"openCart\" [cart]=\"cart\"></app-cart-right>\n</nav>\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}